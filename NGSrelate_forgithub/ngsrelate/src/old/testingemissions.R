# testing emission prob functions
epsilon= 0
geno1=rep(c(0,0,0,1,1,1,2,2,2),3)
geno2=rep(c(0,1,2),9)
ep1 = error_old(geno1,epsilon,81)
ep2 = error_old(geno2,epsilon,81)
freq = rep(0.2,81)
e_old = emission_relateHMM_old(freq,ep1,ep2)
apply(e_old[,1:9],1,sum)
apply(e_old[,10:18],1,sum)
apply(e_old[,19:27],1,sum)
apply(e_old[,28:36],1,sum)
apply(e_old[,37:45],1,sum)
apply(e_old[,46:54],1,sum)
apply(e_old[,55:63],1,sum)
apply(e_old[,64:72],1,sum)
apply(e_old[,73:81],1,sum)

e_new = emission_relateHMM_new(freq,ep1,ep2)
apply(e_new[,1:9],1,sum)
apply(e_new[,10:18],1,sum)
apply(e_new[,19:27],1,sum)
apply(e_new[,28:36],1,sum)
apply(e_new[,37:45],1,sum)
apply(e_new[,46:54],1,sum)
apply(e_new[,55:63],1,sum)
apply(e_new[,64:72],1,sum)
apply(e_new[,73:81],1,sum)

epsilon= 0
geno1=rep(c(0,0,0,1,1,1,2,2,2),3)
geno2=rep(c(0,1,2),9)
ep1 = error_new(geno1,epsilon,81)
ep2 = error_new(geno2,epsilon,81)
freq = rep(0.2,81)
e_old = emission_relateHMM_old(freq,ep1,ep2)
apply(e_old[,1:9],1,sum)
apply(e_old[,10:18],1,sum)
apply(e_old[,19:27],1,sum)
apply(e_old[,28:36],1,sum)
apply(e_old[,37:45],1,sum)
apply(e_old[,46:54],1,sum)
apply(e_old[,55:63],1,sum)
apply(e_old[,64:72],1,sum)
apply(e_old[,73:81],1,sum)

e_new = emission_relateHMM_new(freq,ep1,ep2)
apply(e_new[,1:9],1,sum)
apply(e_new[,10:18],1,sum)
apply(e_new[,19:27],1,sum)
apply(e_new[,28:36],1,sum)
apply(e_new[,37:45],1,sum)
apply(e_new[,46:54],1,sum)
apply(e_new[,55:63],1,sum)
apply(e_new[,64:72],1,sum)
apply(e_new[,73:81],1,sum)
